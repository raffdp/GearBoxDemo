import{r as e,h as a}from"./p-da09bae5.js";const l=class{constructor(a){e(this,a),this.hotkeysToActions={},this.menuItems={children:{}}}componentDidLoad(){this.appData.actionRegistry.actionAdded.connect(()=>{this.makeMenuTree()}),this.makeMenuTree()}keydownHandler(e){if(e.target instanceof HTMLInputElement)return;const a=[];e.shiftKey&&a.push("shift"),e.altKey&&a.push("alt"),e.metaKey&&a.push("ctrl"),e.ctrlKey&&a.push("ctrl"),"Alt"!=e.key&&"Control"!=e.key&&"Ctrl"!=e.key&&"Shift"!=e.key&&a.push(e.key);const l=a.join("+").toLowerCase();l in this.hotkeysToActions&&this.hotkeysToActions[l].callback(e),e.preventDefault()}makeMenuTree(){this.actions=this.appData.actionRegistry.getActions(),this.actions.forEach(e=>{this.getMenuTreeItem(e.path).children[e.name]=e}),this.feedHotKeys()}feedHotKeys(){this.actions.forEach(e=>{const a=this.keyComboAsText(e);a&&(this.hotkeysToActions[a]=e)})}getMenuTreeItem(e){let a=this.menuItems;return e.forEach(e=>{e in a.children||(a.children[e]={children:{}}),a=a.children[e]}),a}makeBranch(e,l){return a("li",{key:e},a("span",{class:"branch-label"},a("span",{class:"branch-name"},e),a("span",{class:"branch-arrow"},this.getBranchArrow())),a("ul",null,this.makeBranchItems(l)))}makeBranchItems(e){const a=[];return Object.keys(e.children).forEach(l=>{const o=e.children[l];a.push("children"in o?this.makeBranch(l,o):this.makeLeaf(l,o))}),a}makeLeaf(e,l){return a("li",{key:e,onClick:e=>{this.hadleLeafClick(e,l)}},a("span",{class:"leaf-label"},a("span",{class:"action-name"},l.name),a("span",{class:"keyboard-shortcut"},this.keyComboAsHtml(l))))}hadleLeafClick(e,a){"callback"in a&&a.callback(),this.flashItem(e.currentTarget)}flashItem(e){e.classList.toggle("flashed");const a=setInterval(()=>{e.classList.toggle("flashed")},80);setTimeout(()=>{clearInterval(a),e.classList.remove("flashed")},100)}keyComboAsHtml(e){const{metaKeys:l,key:o}=e,s=[];return o||l?(l.control&&(s.push(a("span",{class:"keyboard-key"},"Ctrl")),s.push("+")),l.alt&&(s.push(a("span",{class:"keyboard-key"},"Alt")),s.push("+")),l.shift&&(s.push(a("span",{class:"keyboard-key"},"Shift")),s.push("+")),s.push(a("span",{class:"keyboard-key"},o)),s):null}keyComboAsText(e){const{metaKeys:a,key:l}=e,o=[];return l||a?(a&&(a.shift&&o.push("shift"),a.alt&&o.push("alt"),a.control&&o.push("ctrl")),o.push(l),o.join("+").toLowerCase()):""}getBranchArrow(){return a("svg",{class:"branch-arrow-icon",xmlns:"http://www.w3.org/2000/svg",height:"16",viewBox:"0 0 24 24",width:"16"},a("path",{d:"M8 5v14l11-7z"}),a("path",{d:"M0 0h24v24H0z",fill:"none"}))}render(){return a("div",{class:"zea-dropdown-menu"},a("ul",{class:"menu-root"},this.makeBranchItems(this.menuItems)))}};l.style=".zea-dropdown-menu{color:var(--color-foreground-1);font-size:14px}ul,li{display:block;list-style:none;margin:0;padding:0;background-color:var(--color-background-2);cursor:default;position:relative;color:var(--color-foreground-1)}li.flashed>span,li.flashed:hover>span{background-color:var(--color-secondary-3) !important}.menu-root{display:-ms-flexbox;display:flex;-ms-flex-pack:left;justify-content:left;-ms-flex-align:center;align-items:center}ul ul{display:none}.leaf-label,.branch-label{display:inline-block;white-space:nowrap}.menu-root>li>.leaf-label,.menu-root>li>.branch-label{padding:16px}.menu-root>li>.branch-label>.branch-arrow{display:none}li .leaf-label,li .branch-label{padding:8px 8px 8px 16px;display:-ms-flexbox;display:flex}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}ul ul li>.leaf-label{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.branch-name{-ms-flex-positive:1;flex-grow:1}li:hover>span{background-color:var(--color-grey-3)}li:hover>ul{display:block;position:absolute;-webkit-box-shadow:0 6px 13px 0 var(--color-shadow);box-shadow:0 6px 13px 0 var(--color-shadow)}ul ul ul{margin-left:100%;margin-top:-30px}.action-name{min-width:100px;display:block;-ms-flex-positive:1;flex-grow:1}.keyboard-shortcut{display:block;opacity:0.75;font-size:0.8em;padding-left:10px}.branch-arrow-icon{display:block;opacity:0.5}.keyboard-key{border:1px solid var(--color-grey-3);padding:2px;border-radius:5px;font-size:0.8em;text-align:center;min-width:10px;display:inline-block;background-color:var(--color-background-1);text-transform:uppercase;margin:0 2px}";export{l as zea_dropdown_menu}